model ActivityLog {
  id          Int      @id @default(autoincrement())
  user_id     Int
  action      String   @db.VarChar
  description String?  @db.Text
  created_at  DateTime @default(now()) @db.Timestamp
  user        User     @relation(fields: [user_id], references: [id])
}

model Attachment {
  id             Int         @id @default(autoincrement())
  transaction_id Int
  file_path      String      @db.VarChar
  file_type      String      @db.VarChar
  created_at     DateTime    @default(now()) @db.Timestamp
  transaction    Transaction @relation(fields: [transaction_id], references: [id])
}

model Budget {
  id            Int      @id @default(autoincrement())
  user_id       Int
  monthly_limit Decimal  @db.Decimal // Berdasarkan source: 134
  month_year    DateTime @db.Date // Berdasarkan source: 139
  user          User     @relation(fields: [user_id], references: [id])
}

model Category {
  id           Int           @id @default(autoincrement())
  name         String        @db.VarChar
  icon         String?       @db.VarChar
  type         String        @db.VarChar // Pemasukan atau Pengeluaran
  transactions Transaction[]
}

model Notification {
  id         Int      @id @default(autoincrement())
  user_id    Int
  title      String   @db.VarChar
  content    String   @db.Text
  is_read    Boolean  @default(false)
  created_at DateTime @default(now()) @db.Timestamp
  user       User     @relation(fields: [user_id], references: [id])
}

model Otp {
  id         Int      @id @default(autoincrement())
  user_id    Int
  code       String   @db.VarChar
  type       String   @db.VarChar
  expired_at DateTime @db.Timestamp
  user       User     @relation(fields: [user_id], references: [id])
}

model PasswordReset {
  email      String   @id @db.VarChar
  token      String   @db.VarChar
  created_at DateTime @default(now()) @db.Timestamp
}

model RefreshToken {
  id         Int      @id @default(autoincrement())
  user_id    Int
  token      String   @db.VarChar
  expires_at DateTime @db.Timestamp
  user       User     @relation(fields: [user_id], references: [id])
}

model Transaction {
  id               Int      @id @default(autoincrement())
  user_id          Int
  category_id      Int
  wallet_id        Int
  amount           Decimal  @db.Decimal // Berdasarkan source: 142
  type             String   @db.VarChar
  note             String?  @db.Text
  transaction_date DateTime @db.Timestamp

  wallet      Wallet       @relation(fields: [wallet_id], references: [id])
  category    Category     @relation(fields: [category_id], references: [id])
  attachments Attachment[]
}

model User {
  id         Int      @id @default(autoincrement())
  full_name  String   @db.VarChar
  email      String   @unique @db.VarChar // Berdasarkan source: 111
  password   String   @db.VarChar // Berdasarkan source: 137
  role       String?  @db.VarChar
  created_at DateTime @default(now()) @db.Timestamp

  // Relasi
  wallets        Wallet[]
  budgets        Budget[]
  notifications  Notification[]
  otps           Otp[]
  refresh_tokens RefreshToken[]
  activity_logs  ActivityLog[]
}

model Wallet {
  id           Int           @id @default(autoincrement())
  user_id      Int
  name         String        @db.VarChar
  balance      Decimal       @db.Decimal // Berdasarkan source: 152
  created_at   DateTime      @default(now()) @db.Timestamp
  user         User          @relation(fields: [user_id], references: [id])
  transactions Transaction[]
}

// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../generated"
}

datasource db {
  provider = "postgresql"
}
